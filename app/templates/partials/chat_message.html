<!-- User message -->
<div class="flex justify-end">
  <div class="bg-blue-600 text-white rounded-lg px-4 py-2 max-w-[75%] text-sm">
    {{ user_message }}
  </div>
</div>

<!-- AI response -->
{% if error %}
<div class="flex justify-start">
  <div class="bg-red-50 border border-red-200 text-red-700 rounded-lg px-4 py-2 max-w-[75%] text-sm">
    Error: {{ error }}
  </div>
</div>
{% else %}
<div class="flex justify-start">
  <div class="bg-gray-100 rounded-lg px-4 py-2 max-w-[75%] text-sm space-y-2">
    <div class="text-gray-800 whitespace-pre-wrap">{{ ai_message }}</div>
    {% if sources %}
    <div class="border-t border-gray-200 pt-2 mt-2">
      <p class="text-xs font-semibold text-gray-500 mb-1">Sources:</p>
      <ul class="space-y-1">
        {% for src in sources %}
        <li class="text-xs text-gray-500">
          <span class="font-medium text-gray-700">{{ src.file_name }}</span>
          {% if src.page %}<span class="ml-1">Page {{ src.page }}</span>{% endif %}
          {% if src.sheet %}<span class="ml-1">Sheet: {{ src.sheet }}</span>{% endif %}
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>
</div>
{% endif %}
